<!DOCTYPE html>
<html>
<body>

<p id="demo">Hi</p>
<p id="view">v</p>

<script>

var x = 'O';
var y = 0;

function addDot() {
  x = 's' + x;
  y++;
}

function sleep(x) {
  for (var i = 0; i < x; i++) {
    // do nothing
  }
}

function runAsyncFunc(callback) {
  console.log('before callback');
  x += 's';
  callback(x);
  console.log('yo!');
}

function blahBlah() {
  runAsyncFunc(function(x) {
    // we know that the "calculation" has been done now
    console.log(x);
  });
}

function run() {
  var i = 0;
  while (i < 10) {
    try {
      setTimeout(function () {
        x = 's' + x;
        y++;
        document.getElementById('demo').innerHTML=x;
        document.getElementById('view').innerHTML=y;
        console.log(y);
      }, 1000);
      i++;
    } catch (err) {
      txt="There was an error on this page.\n\n";
      txt+='Error description: ' + err.message + "\n\n";
      txt+="Click OK to continue.\n\n";
      alert(txt);
    }
  }
}

try {
  // run();
  blahBlah();
  document.getElementById('demo').innerHTML=x;
  document.getElementById('view').innerHTML=y;
} catch (err) {
  txt="There was an error on this page.\n\n";
  txt+='Error description: ' + err.message + "\n\n";
  txt+="Click OK to continue.\n\n";
  alert(txt);
}
</script>
</body>
</html>